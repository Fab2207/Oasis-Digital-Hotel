import{Ba as c,Ja as u,Oa as l,c as s,e as i,h as o,k as a,n}from"./chunk-DBIQ3VVQ.js";var U=(()=>{class r{constructor(t,e){this.http=t,this.router=e,this.apiUrl=`${l.apiUrl}/auth`,this.currentUserSubject=new s(null),this.currentUser$=this.currentUserSubject.asObservable(),this.loadUserFromStorage()}loadUserFromStorage(){let t=localStorage.getItem("currentUser");t&&this.currentUserSubject.next(JSON.parse(t))}login(t){return this.http.post(`${this.apiUrl}/login`,t).pipe(o(e=>{localStorage.setItem("token",e.token),localStorage.setItem("currentUser",JSON.stringify(e)),this.currentUserSubject.next(e)}))}register(t){return this.http.post(`${this.apiUrl}/register`,t).pipe(o(e=>{localStorage.setItem("token",e.token),localStorage.setItem("currentUser",JSON.stringify(e)),this.currentUserSubject.next(e)}))}logout(){localStorage.removeItem("token"),localStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.navigate(["/"])}getToken(){return localStorage.getItem("token")}isAuthenticated(){return!!this.getToken()}get isAdmin$(){return this.currentUser$.pipe(i(t=>t?.role==="ROLE_ADMIN"))}get isRecepcionista$(){return this.currentUser$.pipe(i(t=>t?.role==="ROLE_RECEPCIONISTA"))}get isCliente$(){return this.currentUser$.pipe(i(t=>t?.role==="ROLE_CLIENTE"))}static{this.\u0275fac=function(e){return new(e||r)(n(c),n(u))}}static{this.\u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{U as a};
