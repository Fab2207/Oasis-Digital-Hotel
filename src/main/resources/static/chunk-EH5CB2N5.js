import{a as O}from"./chunk-YHTGSJXL.js";import{a as A}from"./chunk-HAICC4VJ.js";import{b as D,c as N,d as F,e as j,f as W,g as L,p as k,q as z,r as G,s as B}from"./chunk-SW222O52.js";import{$ as h,D as a,E as x,H as f,J as d,N as n,O as t,P as C,S as w,T as S,U as c,W as E,X as l,Y as u,Z as b,_ as I,aa as v,ba as y,da as P,q as _,sa as M,u as m,ua as T,v as p,za as V}from"./chunk-DBIQ3VVQ.js";function U(o,g){if(o&1&&(n(0,"div",33)(1,"span",32),l(2),t(),l(3),t()),o&2){let e=c(2);d("ngClass",e.messageType==="success"?"bg-green-500/10 text-green-400 border-green-500/20":"bg-red-500/10 text-red-400 border-red-500/20"),a(2),u(e.messageType==="success"?"check_circle":"error"),a(),b(" ",e.message," ")}}function q(o,g){o&1&&(n(0,"p",34),l(1," Debe tener exactamente 9 d\xEDgitos. "),t())}function H(o,g){if(o&1){let e=w();n(0,"div",3)(1,"div",4)(2,"h1",5),l(3,"Mi Perfil"),t(),n(4,"p",6),l(5,"Informaci\xF3n personal y de contacto."),t()(),n(6,"div",7)(7,"div",8)(8,"div",9)(9,"span",10),l(10,"person"),t()(),n(11,"div",11)(12,"h2",12),l(13),t(),n(14,"p",6),l(15),t(),n(16,"div",13)(17,"span",14)(18,"span",15),l(19,"check_circle"),t(),l(20," Cliente Verificado "),t()()()(),f(21,U,4,3,"div",16),n(22,"form",17,0),S("ngSubmit",function(){m(e);let r=c();return p(r.saveProfile())}),n(24,"div",18)(25,"div",19)(26,"label",20),l(27,"DNI / Documento (No Editable)"),t(),n(28,"div",21)(29,"span",22),l(30,"badge"),t(),n(31,"span",23),l(32),t()()(),n(33,"div",19)(34,"label",20),l(35,"Tel\xE9fono"),t(),n(36,"div",24)(37,"span",25)(38,"span",26),l(39,"call"),t()(),n(40,"input",27),y("ngModelChange",function(r){m(e);let s=c();return v(s.cliente.telefono,r)||(s.cliente.telefono=r),p(r)}),t()(),f(41,q,2,0,"p",28),t()(),n(42,"div",19)(43,"label",20),l(44,"Nacionalidad"),t(),n(45,"div",24)(46,"span",25)(47,"span",26),l(48,"public"),t()(),n(49,"input",29),y("ngModelChange",function(r){m(e);let s=c();return v(s.cliente.nacionalidad,r)||(s.cliente.nacionalidad=r),p(r)}),t()()(),n(50,"div",30)(51,"button",31)(52,"span",32),l(53,"save_as"),t(),l(54),t()()()()()}if(o&2){let e=E(23),i=c();a(13),I("",i.cliente.nombres," ",i.cliente.apellidos,""),a(2),u(i.cliente.email),a(6),d("ngIf",i.message),a(11),u(i.cliente.dni),a(8),h("ngModel",i.cliente.telefono),a(),d("ngIf",(e.controls.telefono==null?null:e.controls.telefono.invalid)&&((e.controls.telefono==null?null:e.controls.telefono.dirty)||(e.controls.telefono==null?null:e.controls.telefono.touched))),a(8),h("ngModel",i.cliente.nacionalidad),a(2),d("disabled",i.loading||e.invalid),a(3),b(" ",i.loading?"Guardando...":"Guardar Cambios"," ")}}function J(o,g){o&1&&(n(0,"div",35),C(1,"div",36),t())}var ee=(()=>{class o{constructor(e,i){this.authService=e,this.clienteService=i,this.cliente=null,this.loading=!1,this.loadingData=!0,this.message="",this.messageType="success"}ngOnInit(){this.loadProfile()}loadProfile(){this.authService.currentUser$.subscribe(e=>{e&&e.username&&this.clienteService.buscar(e.username.trim()).subscribe({next:i=>{let r=i.find(s=>s.email===e.username||s.usuario?.username===e.username)||i[0];this.cliente=r,this.loadingData=!1},error:()=>this.loadingData=!1})})}saveProfile(){this.cliente&&(this.loading=!0,this.message="",this.clienteService.actualizar(this.cliente.id,this.cliente).subscribe({next:e=>{this.loadProfile(),this.loading=!1,this.message="Perfil actualizado correctamente. Los datos se han recargado.",this.messageType="success"},error:e=>{console.error(e),this.loading=!1,this.message="Error al actualizar el perfil",this.messageType="error"}}))}static{this.\u0275fac=function(i){return new(i||o)(x(A),x(O))}}static{this.\u0275cmp=_({type:o,selectors:[["app-client-profile"]],standalone:!0,features:[P],decls:2,vars:2,consts:[["profileForm","ngForm"],["class","max-w-4xl mx-auto space-y-8 animate-fade-in",4,"ngIf"],["class","flex justify-center py-20",4,"ngIf"],[1,"max-w-4xl","mx-auto","space-y-8","animate-fade-in"],[1,"flex","flex-col","gap-1"],[1,"text-3xl","font-bold","text-white"],[1,"text-white/60","text-sm"],[1,"bg-[#121212]","border","border-white/10","rounded-2xl","p-8"],[1,"flex","flex-col","md:flex-row","gap-8","mb-8","items-start","md:items-center"],[1,"w-24","h-24","rounded-full","border","border-green-500/30","flex","items-center","justify-center","bg-[#121212]","relative","group"],[1,"material-symbols-outlined","text-green-500","text-4xl"],[1,"space-y-1"],[1,"text-2xl","font-bold","text-white"],[1,"pt-2"],[1,"inline-flex","items-center","gap-1","px-3","py-1","rounded-full","border","border-green-500","text-green-500","text-[10px]","font-bold","uppercase","tracking-wider"],[1,"material-symbols-outlined","text-xs"],["class","px-4 py-3 rounded-lg border mb-6 flex items-center gap-2",3,"ngClass",4,"ngIf"],[1,"space-y-6",3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-2"],[1,"text-xs","font-bold","text-white/40","uppercase","tracking-wider"],[1,"bg-[#1A1A1A]","border","border-white/10","rounded-lg","px-4","py-3","flex","items-center","gap-3","text-white/50"],[1,"material-symbols-outlined"],[1,"font-bold"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","text-white/40","pointer-events-none"],[1,"material-symbols-outlined","text-sm"],["type","text","name","telefono","pattern","[0-9]{9}","maxlength","9","minlength","9","placeholder","930438121",1,"w-full","bg-[#1A1A1A]","border","border-white/10","rounded-lg","pl-10","pr-4","py-3","text-white","focus:border-green-500","focus:outline-none","transition-colors","invalid:border-red-500/50","focus:invalid:border-red-500",3,"ngModelChange","ngModel"],["class","text-xs text-red-400 mt-1",4,"ngIf"],["type","text","name","nacionalidad","placeholder","Peruana",1,"w-full","bg-[#1A1A1A]","border","border-white/10","rounded-lg","pl-10","pr-4","py-3","text-white","focus:border-green-500","focus:outline-none","transition-colors",3,"ngModelChange","ngModel"],[1,"pt-8","flex","justify-end"],["type","submit",1,"bg-[#00A67E]","text-white","font-bold","h-12","px-6","rounded-lg","hover:bg-[#008f6d]","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],[1,"material-symbols-outlined","text-lg"],[1,"px-4","py-3","rounded-lg","border","mb-6","flex","items-center","gap-2",3,"ngClass"],[1,"text-xs","text-red-400","mt-1"],[1,"flex","justify-center","py-20"],[1,"animate-spin","rounded-full","h-12","w-12","border-t-2","border-primary"]],template:function(i,r){i&1&&f(0,H,55,10,"div",1)(1,J,2,0,"div",2),i&2&&(d("ngIf",r.cliente),a(),d("ngIf",!r.cliente&&r.loadingData))},dependencies:[V,M,T,B,L,D,N,F,k,z,G,W,j],encapsulation:2})}}return o})();export{ee as ClientProfileComponent};
