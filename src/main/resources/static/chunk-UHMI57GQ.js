import{Ba as h,Ga as d,Ja as u,Oa as p,g as l,k as m,n as i}from"./chunk-DBIQ3VVQ.js";var P=(()=>{class s{constructor(t,e){this.router=t,this.http=e,this.PRIMARY_KEY="theme-primary",this.ACCENT_KEY="theme-accent",this.BORDER_KEY="theme-border",this.currentPrimary="#047857",this.currentAccent="#d4af37",this.loadLocalTheme(),this.loadGlobalConfig(),this.router.events.pipe(l(r=>r instanceof d)).subscribe(r=>{let o=r.urlAfterRedirects||r.url;this.handleRouteTheme(o)})}loadGlobalConfig(){this.http.get(`${p.apiUrl}/configuracion/public`).subscribe({next:t=>{t&&t.colorPrimario&&(this.currentPrimary=t.colorPrimario,this.currentAccent=t.colorAcento,t.borderRadius&&this.setBorderRadius(t.borderRadius,!1),localStorage.setItem(this.PRIMARY_KEY,this.currentPrimary),localStorage.setItem(this.ACCENT_KEY,this.currentAccent),this.handleRouteTheme(this.router.url))},error:t=>console.log("Using local/default theme")})}handleRouteTheme(t){["/","/login","/register","/home","/index"].some(o=>t===o||t===o+"/"||t.startsWith("/login")||t.startsWith("/register"))?this.applyTheme("#047857","#d4af37"):this.applyTheme(this.currentPrimary,this.currentAccent)}loadLocalTheme(){let t=localStorage.getItem(this.PRIMARY_KEY),e=localStorage.getItem(this.ACCENT_KEY),r=localStorage.getItem(this.BORDER_KEY);t&&e&&(this.currentPrimary=t,this.currentAccent=e,this.applyTheme(t,e)),r&&this.setBorderRadius(r,!1)}applyTheme(t,e){let r=this.hexToRgb(t),o=this.hexToRgb(e);document.documentElement.style.setProperty("--color-primary",t),document.documentElement.style.setProperty("--color-primary-rgb",r),document.body.style.setProperty("--color-primary",t),document.body.style.setProperty("--color-primary-rgb",r),document.documentElement.style.setProperty("--color-accent",e),document.documentElement.style.setProperty("--color-accent-rgb",o),document.body.style.setProperty("--color-accent",e),document.body.style.setProperty("--color-accent-rgb",o)}updateTheme(t,e){this.currentPrimary=t,this.currentAccent=e,this.applyTheme(t,e),localStorage.setItem(this.PRIMARY_KEY,t),localStorage.setItem(this.ACCENT_KEY,e)}hexToRgb(t){let e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,(o,c,a,n)=>c+c+a+a+n+n);let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return r?`${parseInt(r[1],16)} ${parseInt(r[2],16)} ${parseInt(r[3],16)}`:"0 0 0"}setBorderRadius(t,e=!0){document.documentElement.style.setProperty("--radius",t),e&&localStorage.setItem(this.BORDER_KEY,t)}static{this.\u0275fac=function(e){return new(e||s)(i(u),i(h))}}static{this.\u0275prov=m({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{P as a};
