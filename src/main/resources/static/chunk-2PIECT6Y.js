import{a as ee}from"./chunk-6AL5JYWX.js";import{a as se}from"./chunk-YPPC7AQK.js";import{a as le}from"./chunk-YG3CPSL3.js";import{a as re}from"./chunk-IOAMSEWY.js";import"./chunk-HAICC4VJ.js";import{b as te,c as ie,f as ne,i as ae,s as oe}from"./chunk-SW222O52.js";import{$ as E,D as s,E as D,H as g,J as p,K as z,Ka as Q,L as I,N as i,Na as X,O as n,P as b,Q as P,R as V,S as R,T as u,U as h,X as r,Y as x,Z as C,aa as k,ba as T,da as B,ea as W,f as F,fa as A,ga as G,ja as H,ka as $,ma as q,q as L,sa as U,ta as J,u as O,ua as Y,v as j,xa as Z,za as K}from"./chunk-DBIQ3VVQ.js";var de=()=>["/notificaciones"],ce=a=>({id:a}),pe=(a,d)=>({"bg-white/5":a,"opacity-70":d}),me=a=>({"bg-primary/5 text-primary font-bold":a}),he=(a,d,e,o,t)=>({"bg-green-600 shadow-[inset_0_0_20px_rgba(0,0,0,0.2)]":a,"bg-yellow-500/60":d,"bg-blue-500/60":e,"bg-red-500/80":o,"hover:bg-white/5":t});function fe(a,d){a&1&&b(0,"span",45)}function ue(a,d){if(a&1){let e=R();i(0,"div",55),u("click",function(){let t=O(e).$implicit,c=h(2);return c.markAsRead(t),j(c.toggleNotifications())}),i(1,"p",56),r(2),n(),i(3,"p",57),r(4),n(),i(5,"div",58)(6,"span",59),r(7),n(),i(8,"p",60),r(9),$(10,"date"),n()()()}if(a&2){let e=d.$implicit;p("routerLink",W(10,de))("queryParams",A(11,ce,e.id))("ngClass",G(13,pe,!e.leida,e.leida)),s(2),C(" ",e.titulo," "),s(2),C(" ",e.mensaje," "),s(3),x(e.tipo),s(2),C(" ",q(10,7,e.fechaCreacion,"short")," ")}}function ge(a,d){a&1&&(i(0,"div",61)(1,"span",62),r(2,"notifications_off"),n(),r(3," No tienes notificaciones "),n())}function be(a,d){if(a&1&&(i(0,"div",46)(1,"div",47)(2,"h3",48),r(3,"Notificaciones"),n(),i(4,"span",49),r(5),n()(),i(6,"div",50),g(7,ue,11,16,"div",51)(8,ge,4,0,"div",52),n(),i(9,"div",53)(10,"a",54),r(11," Ver todas "),n()()()),a&2){let e=h();s(5),C("",e.unreadCount," nuevas"),s(2),p("ngForOf",e.notifications),s(),p("ngIf",e.notifications.length===0)}}function xe(a,d){if(a&1&&(i(0,"div",63)(1,"span",64),r(2),n(),i(3,"span",65),r(4),n()()),a&2){let e=d.$implicit;p("ngClass",A(3,me,e.esHoy)),s(2),x(e.nombre.substring(0,3)),s(2),x(e.nombre.slice(3).trim())}}function we(a,d){a&1&&(i(0,"div",73)(1,"span",74),r(2,"check_circle"),n()())}function ve(a,d){if(a&1&&(i(0,"span",78),r(1),n()),a&2){let e=h(2).$implicit,o=h().$implicit,t=h();s(),x(t.getDiaInfo(o.id,e.fecha).cliente)}}function _e(a,d){if(a&1&&(i(0,"div",75)(1,"span",76),r(2),n(),g(3,ve,2,1,"span",77),n()),a&2){let e=h().$implicit,o=h().$implicit,t=h();s(2),x(t.getDiaInfo(o.id,e.fecha).estado),s(),p("ngIf",t.getDiaInfo(o.id,e.fecha).cliente)}}function ye(a,d){if(a&1&&(i(0,"div",70),g(1,we,3,0,"div",71)(2,_e,4,2,"div",72),n()),a&2){let e=d.$implicit,o=h().$implicit,t=h();p("ngClass",H(3,he,t.getDiaInfo(o.id,e.fecha).estado==="ACTIVA"||t.getDiaInfo(o.id,e.fecha).estado==="OCUPADA",t.getDiaInfo(o.id,e.fecha).estado==="PENDIENTE",t.getDiaInfo(o.id,e.fecha).estado==="FINALIZADA",t.getDiaInfo(o.id,e.fecha).estado==="MANTENIMIENTO",t.getDiaInfo(o.id,e.fecha).estado==="LIBRE")),s(),p("ngIf",t.getDiaInfo(o.id,e.fecha).estado==="ACTIVA"),s(),p("ngIf",t.getDiaInfo(o.id,e.fecha).estado!=="LIBRE")}}function Ce(a,d){if(a&1&&(P(0),i(1,"div",66)(2,"span",67),r(3),n(),i(4,"span",68),r(5),n()(),g(6,ye,3,9,"div",69),V()),a&2){let e=d.$implicit,o=h();s(3),x(e.numero),s(2),x(e.tipo),s(),p("ngForOf",o.diasMes)}}var je=(()=>{class a{constructor(e,o,t){this.habitacionService=e,this.reservaService=o,this.dashboardService=t,this.currentDate=new Date,this.view="month",this.mesAnio="",this.diasMes=[],this.habitaciones=[],this.reservas=[],this.disponibilidad={},this.showNotifications=!1,this.notifications=[],this.unreadCount=0}ngOnInit(){this.loadData(),this.loadNotifications()}loadNotifications(){this.dashboardService.getNotifications().subscribe({next:e=>{this.notifications=e||[],this.unreadCount=this.notifications.filter(o=>!o.leida).length},error:e=>console.error("Error loading notifications",e)})}toggleNotifications(){this.showNotifications=!this.showNotifications}markAsRead(e){e.leida||this.dashboardService.markAsRead(e.id).subscribe(()=>{e.leida=!0,this.unreadCount=Math.max(0,this.unreadCount-1)})}loadData(){F({habitaciones:this.habitacionService.getAll(),reservas:this.reservaService.getAll()}).subscribe(({habitaciones:e,reservas:o})=>{this.habitaciones=e,this.reservas=o,this.generateGrid()})}generateGrid(){let e,o,t=this.currentDate.getFullYear(),c=this.currentDate.getMonth();if(this.view==="week"){let l=this.currentDate.getDay(),w=this.currentDate.getDate()-l+(l===0?-6:1);e=new Date(this.currentDate),e.setDate(w),o=new Date(e),o.setDate(e.getDate()+6),this.mesAnio=`Semana del ${e.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}`}else this.view==="day"?(e=new Date(this.currentDate),o=new Date(this.currentDate),this.mesAnio=this.currentDate.toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})):(e=new Date(t,c,1),o=new Date(t,c+1,0),this.mesAnio=this.currentDate.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),this.mesAnio=this.mesAnio.charAt(0).toUpperCase()+this.mesAnio.slice(1));this.diasMes=[];let m=new Date().toISOString().split("T")[0],_=new Date(e);for(;_<=o;){let l=_.toISOString().split("T")[0];this.diasMes.push({fecha:l,nombre:_.toLocaleDateString("es-ES",{weekday:"short",day:"2-digit"}),esHoy:l===m,dateObj:new Date(_)}),_.setDate(_.getDate()+1)}this.disponibilidad={},this.habitaciones.forEach(l=>{this.disponibilidad[l.id]={},this.diasMes.forEach(w=>{this.disponibilidad[l.id][w.fecha]={estado:"LIBRE"}})}),this.reservas.forEach(l=>{if(l.estado==="CANCELADA"||!(l.habitacionId||(l.habitacion?l.habitacion.id:null))&&!this.habitaciones.find(y=>String(y.numero)===String(l.habitacionNumero)))return;let v=new Date(l.fechaInicio);if(typeof l.fechaInicio=="string"){let f=l.fechaInicio.split("-");v=new Date(parseInt(f[0]),parseInt(f[1])-1,parseInt(f[2]))}let S=new Date(l.fechaFin);if(typeof l.fechaFin=="string"){let f=l.fechaFin.split("-");S=new Date(parseInt(f[0]),parseInt(f[1])-1,parseInt(f[2]))}let N=v.getTime()===S.getTime();for(;v<S||N&&v.getTime()===S.getTime();){let f=v.toLocaleDateString("sv").split("T")[0],y=this.habitaciones.find(M=>l.habitacion&&M.id===l.habitacion.id||l.habitacionId===M.id||String(M.numero)===String(l.habitacionNumero));if(y&&this.disponibilidad[y.id]&&this.disponibilidad[y.id][f]&&(this.disponibilidad[y.id][f]={estado:l.estado,tipo:l.estado,cliente:l.clienteNombre,reservaId:l.id}),v.setDate(v.getDate()+1),N)break}}),this.habitaciones.forEach(l=>{if(l.estado==="MANTENIMIENTO"){let w=new Date().toLocaleDateString("sv").split("T")[0];this.disponibilidad[l.id][w]&&(this.disponibilidad[l.id][w].estado="MANTENIMIENTO")}})}navigate(e){this.view==="month"?this.currentDate.setMonth(this.currentDate.getMonth()+e):this.view==="week"?this.currentDate.setDate(this.currentDate.getDate()+e*7):this.currentDate.setDate(this.currentDate.getDate()+e),this.generateGrid()}setToday(){this.currentDate=new Date,this.generateGrid()}setView(e){this.view=e,this.generateGrid()}getDiaInfo(e,o){return this.disponibilidad[e]?.[o]||{estado:"LIBRE"}}static{this.\u0275fac=function(o){return new(o||a)(D(se),D(le),D(ee))}}static{this.\u0275cmp=L({type:a,selectors:[["app-calendario"]],standalone:!0,features:[B],decls:80,vars:28,consts:[[1,"flex","h-screen","bg-background-dark","overflow-hidden"],[1,"hidden","md:block"],[1,"flex-1","flex","flex-col","min-w-0","overflow-hidden","relative"],[1,"absolute","top-0","left-0","w-full","h-full","overflow-hidden","-z-10","pointer-events-none"],[1,"absolute","top-[-10%]","right-[-5%]","w-[500px]","h-[500px]","rounded-full","bg-primary/5","blur-[100px]"],[1,"absolute","bottom-[-10%]","left-[-5%]","w-[500px]","h-[500px]","rounded-full","bg-accent/5","blur-[100px]"],[1,"flex","flex-1","flex-col","overflow-y-auto","scroll-smooth","p-8"],[1,"mx-auto","max-w-full","w-full","flex","flex-col","gap-6"],[1,"flex","flex-wrap","justify-between","items-center","gap-4"],[1,"flex","flex-col","gap-1"],[1,"text-white","text-3xl","font-bold","tracking-tight"],[1,"text-white/60","text-base","font-medium"],[1,"relative"],["type","button",1,"relative","p-2","text-white/60","hover:text-white","transition-colors","rounded-full","hover:bg-white/5","cursor-pointer","z-50",3,"click"],[1,"material-symbols-outlined","pointer-events-none"],["class","absolute top-2 right-2 w-2 h-2 bg-accent rounded-full border-2 border-[#121212] pointer-events-none",4,"ngIf"],["class","absolute right-0 top-full mt-2 w-80 bg-[#1e1e1e] border border-white/10 rounded-lg shadow-xl overflow-hidden z-[100]",4,"ngIf"],[1,"glass-panel","rounded-2xl","p-2","flex","flex-wrap","items-center","justify-between","gap-4","border","border-white/10","shadow-xl"],[1,"flex","items-center","gap-2"],[1,"flex","items-center","justify-center","rounded-xl","h-10","px-6","bg-primary","text-white","text-sm","font-bold","hover:bg-primary/90","transition-all","duration-200","shadow-lg","shadow-primary/20","hover:scale-105",3,"click"],[1,"truncate"],[1,"flex","gap-1","bg-white/5","rounded-xl","p-1","border","border-white/5"],[1,"p-2","text-white/60","rounded-lg","hover:bg-white/10","hover:text-white","transition-colors",3,"click"],[1,"material-symbols-outlined"],[1,"text-xl","font-bold","text-white","px-4"],[1,"flex","items-center","gap-4"],[1,"flex","h-10","bg-black/20","rounded-xl","p-1","border","border-white/5"],[1,"flex","cursor-pointer","h-full","items-center","justify-center","px-4","rounded-lg","transition-all","duration-200"],["type","radio","name","view","value","day",1,"hidden",3,"ngModelChange","change","ngModel"],["type","radio","name","view","value","week",1,"hidden",3,"ngModelChange","change","ngModel"],["type","radio","name","view","value","month",1,"hidden",3,"ngModelChange","change","ngModel"],[1,"flex","gap-2"],[1,"p-2.5","text-white/60","rounded-xl","bg-white/5","border","border-white/5","hover:bg-white/10","hover:text-white","transition-colors"],[1,"flex","items-center","gap-6","px-4"],[1,"size-3","rounded-full","bg-white/10","border","border-white/20"],[1,"text-xs","font-medium","text-white/60","uppercase","tracking-wider"],[1,"size-3","rounded-full","bg-accent","shadow-[0_0_10px_rgba(212,175,55,0.4)]"],[1,"size-3","rounded-full","bg-blue-400","shadow-[0_0_10px_rgba(96,165,250,0.4)]"],[1,"size-3","rounded-full","bg-red-400","shadow-[0_0_10px_rgba(248,113,113,0.4)]"],[1,"glass-panel","rounded-2xl","border","border-white/10","p-1","overflow-hidden","shadow-2xl"],[1,"overflow-x-auto","custom-scrollbar"],[1,"grid","min-w-max"],[1,"sticky","left-0","z-20","bg-[#1A1A1A]","p-4","border-b","border-r","border-white/10","text-xs","font-bold","text-white/40","uppercase","tracking-wider","flex","items-center","justify-center","backdrop-blur-xl"],["class","text-center p-3 border-b border-white/5 text-xs font-medium text-white/60 flex flex-col items-center justify-center gap-1",3,"ngClass",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"absolute","top-2","right-2","w-2","h-2","bg-accent","rounded-full","border-2","border-[#121212]","pointer-events-none"],[1,"absolute","right-0","top-full","mt-2","w-80","bg-[#1e1e1e]","border","border-white/10","rounded-lg","shadow-xl","overflow-hidden","z-[100]"],[1,"p-3","border-b","border-white/10","flex","justify-between","items-center","bg-white/5"],[1,"text-white","font-bold","text-sm"],[1,"text-xs","text-[#a0a0a0]"],[1,"max-h-80","overflow-y-auto"],["class","p-3 border-b border-white/5 hover:bg-white/5 cursor-pointer transition-colors",3,"routerLink","queryParams","ngClass","click",4,"ngFor","ngForOf"],["class","p-8 text-center text-[#a0a0a0] text-sm flex flex-col items-center",4,"ngIf"],[1,"p-2","border-t","border-white/10","bg-white/5"],["routerLink","/notificaciones",1,"block","w-full","py-2","text-center","text-xs","font-bold","text-primary","hover:bg-white/5","rounded","transition-colors","cursor-pointer"],[1,"p-3","border-b","border-white/5","hover:bg-white/5","cursor-pointer","transition-colors",3,"click","routerLink","queryParams","ngClass"],[1,"text-sm","text-white","font-medium"],[1,"text-xs","text-[#a0a0a0]","mt-1","line-clamp-2"],[1,"flex","justify-between","items-center","mt-2"],[1,"text-[10px]","px-1.5","py-0.5","rounded","bg-white/10","text-white/50"],[1,"text-[10px]","text-white/40"],[1,"p-8","text-center","text-[#a0a0a0]","text-sm","flex","flex-col","items-center"],[1,"material-symbols-outlined","text-3xl","mb-2","opacity-30"],[1,"text-center","p-3","border-b","border-white/5","text-xs","font-medium","text-white/60","flex","flex-col","items-center","justify-center","gap-1",3,"ngClass"],[1,"uppercase","text-[10px]","opacity-60"],[1,"text-lg"],[1,"sticky","left-0","z-10","bg-[#1A1A1A]","p-3","border-r","border-b","border-white/10","flex","flex-col","justify-center","backdrop-blur-xl","group","hover:bg-white/5","transition-colors"],[1,"font-bold","text-white","text-sm","group-hover:text-primary","transition-colors"],[1,"text-[10px]","text-white/40","truncate"],["class","border-b border-r border-white/5 h-16 transition-all duration-200 relative group cursor-pointer hover:brightness-110",3,"ngClass",4,"ngFor","ngForOf"],[1,"border-b","border-r","border-white/5","h-16","transition-all","duration-200","relative","group","cursor-pointer","hover:brightness-110",3,"ngClass"],["class","w-full h-full flex items-center justify-center text-white/80",4,"ngIf"],["class","hidden group-hover:flex absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-black/90 border border-white/10 text-white text-xs rounded-lg whitespace-nowrap z-30 shadow-xl flex-col gap-1 backdrop-blur-md",4,"ngIf"],[1,"w-full","h-full","flex","items-center","justify-center","text-white/80"],[1,"material-symbols-outlined","text-lg"],[1,"hidden","group-hover:flex","absolute","bottom-full","left-1/2","-translate-x-1/2","mb-2","px-3","py-2","bg-black/90","border","border-white/10","text-white","text-xs","rounded-lg","whitespace-nowrap","z-30","shadow-xl","flex-col","gap-1","backdrop-blur-md"],[1,"font-bold","text-primary"],["class","text-white/80",4,"ngIf"],[1,"text-white/80"]],template:function(o,t){o&1&&(i(0,"div",0)(1,"div",1),b(2,"app-sidebar"),n(),i(3,"div",2)(4,"div",3),b(5,"div",4)(6,"div",5),n(),i(7,"main",6)(8,"div",7)(9,"header",8)(10,"div",9)(11,"h1",10),r(12," Calendario de Disponibilidad "),n(),i(13,"p",11),r(14," Gestiona la disponibilidad de las habitaciones, reservas y estados. "),n()(),i(15,"div",12)(16,"button",13),u("click",function(){return t.toggleNotifications()}),i(17,"span",14),r(18,"notifications"),n(),g(19,fe,1,0,"span",15),n(),g(20,be,12,3,"div",16),n()(),i(21,"div",17)(22,"div",18)(23,"button",19),u("click",function(){return t.setToday()}),i(24,"span",20),r(25,"Hoy"),n()(),i(26,"div",21)(27,"button",22),u("click",function(){return t.navigate(-1)}),i(28,"span",23),r(29,"chevron_left"),n()(),i(30,"button",22),u("click",function(){return t.navigate(1)}),i(31,"span",23),r(32,"chevron_right"),n()()(),i(33,"h2",24),r(34),n()(),i(35,"div",25)(36,"div",26)(37,"label",27)(38,"span",20),r(39,"D\xEDa"),n(),i(40,"input",28),T("ngModelChange",function(m){return k(t.view,m)||(t.view=m),m}),u("change",function(){return t.setView("day")}),n()(),i(41,"label",27)(42,"span",20),r(43,"Semana"),n(),i(44,"input",29),T("ngModelChange",function(m){return k(t.view,m)||(t.view=m),m}),u("change",function(){return t.setView("week")}),n()(),i(45,"label",27)(46,"span",20),r(47,"Mes"),n(),i(48,"input",30),T("ngModelChange",function(m){return k(t.view,m)||(t.view=m),m}),u("change",function(){return t.setView("month")}),n()()(),i(49,"div",31)(50,"button",32)(51,"span",23),r(52,"filter_list"),n()(),i(53,"button",32)(54,"span",23),r(55,"sort"),n()()()()(),i(56,"div",33)(57,"div",18),b(58,"div",34),i(59,"span",35),r(60,"Disponible"),n()(),i(61,"div",18),b(62,"div",36),i(63,"span",35),r(64,"Ocupada"),n()(),i(65,"div",18),b(66,"div",37),i(67,"span",35),r(68,"Limpieza"),n()(),i(69,"div",18),b(70,"div",38),i(71,"span",35),r(72,"Bloqueada"),n()()(),i(73,"div",39)(74,"div",40)(75,"div",41)(76,"div",42),r(77," Habitaci\xF3n "),n(),g(78,xe,5,5,"div",43)(79,Ce,7,3,"ng-container",44),n()()()()()()()),o&2&&(s(19),p("ngIf",t.unreadCount>0),s(),p("ngIf",t.showNotifications),s(14),C(" ",t.mesAnio," "),s(3),I("bg-primary",t.view==="day")("text-white",t.view==="day")("text-white-40",t.view!=="day"),s(3),E("ngModel",t.view),s(),I("bg-primary",t.view==="week")("text-white",t.view==="week")("text-white-40",t.view!=="week"),s(3),E("ngModel",t.view),s(),I("bg-primary",t.view==="month")("text-white",t.view==="month")("text-white-40",t.view!=="month"),s(3),E("ngModel",t.view),s(27),z("grid-template-columns","150px repeat("+t.diasMes.length+", minmax(60px, 1fr))"),s(3),p("ngForOf",t.diasMes),s(),p("ngForOf",t.habitaciones))},dependencies:[K,U,J,Y,Z,oe,te,ae,ie,ne,re,X,Q]})}}return a})();export{je as CalendarioComponent};
